This is the fourth HEAPPEST part of code.